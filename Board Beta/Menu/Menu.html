<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gatundos Menu</title>
  <style>
    :root {
      --sidebar-width: 260px;
      --bg: #0f1115;
      --panel: #161a22;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #6ee7b7;
      --link-hover: #a7f3d0;
      --border: #222634;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Arial, sans-serif;
      color: var(--text);
      background: var(--bg);
      display: grid;
      grid-template-columns: var(--sidebar-width) 1fr;
      grid-template-rows: auto 1fr;
      grid-template-areas:
        "sidebar header"
        "sidebar main";
      min-height: 100vh;
    }

    /* Sidebar */
    aside {
      grid-area: sidebar;
      position: sticky;
      top: 0;
      align-self: start;
      height: 100dvh;
      padding: 20px 16px;
      background: var(--panel);
      border-right: 1px solid var(--border);
      overflow: auto;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
      font-weight: 700;
      letter-spacing: .4px;
    }
    .brand .dot {
      width: 10px; height: 10px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 14px var(--accent);
    }
    nav ul { list-style: none; margin: 12px 0 0; padding: 0; }
    nav li { margin: 6px 0; }
    nav a {
      display: block;
      padding: 10px 12px;
      color: var(--text);
      text-decoration: none;
      border-radius: 8px;
      transition: background .2s, color .2s;
    }
    nav a:hover { background: #1f2533; color: var(--link-hover); }
    nav a.active { background: #1b2130; outline: 1px solid #273049; }

    /* Header */
    header {
      grid-area: header;
      background: linear-gradient(180deg, #0f1115 0%, #0f1115cc 100%);
      border-bottom: 1px solid var(--border);
      padding: 16px 20px 12px;
    }
    .top-image-wrap {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .top-image {
      max-width: min(820px, 92%);
      width: 100%;
      height: auto;
      display: block;
      border-radius: 12px;
      outline: 1px solid var(--border);
    }

    /* Main com iframe */
    main {
      grid-area: main;
      padding: 20px;
      overflow: hidden;
    }
    .frame-wrap {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      height: calc(100dvh - 20px - 12px - 16px - 20px);
      min-height: 400px;
      overflow: hidden;
      position: relative; /* necessário para posicionar o botão fechar */
    }
    iframe#viewer {
      border: none;
      width: 100%;
      height: 100%;
      display: block;
    }

    /* Botão fechar (visível somente em fullscreen via :fullscreen) */
    #btnCloseFull {
      position: absolute;
      top: 12px;
      right: 12px;
      z-index: 2;
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #0f1115cc;
      color: var(--text);
      cursor: pointer;
      display: none;
    }

    /* Estilização específica em fullscreen */
    .frame-wrap:fullscreen #btnCloseFull { display: inline-block; }
    .frame-wrap:fullscreen { border-radius: 0; border: none; }

    /* Esconde sidebar e header enquanto o contêiner está fullscreen */
    .frame-wrap:fullscreen ~ aside,
    .frame-wrap:fullscreen ~ header {
      display: none;
    }

    /* Responsivo */
    @media (max-width: 960px) {
      body {
        grid-template-columns: 1fr;
        grid-template-areas:
          "header"
          "sidebar"
          "main";
      }
      aside {
        position: relative;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
      .frame-wrap { height: 70dvh; }
    }
  </style>
</head>
<body>
  <aside>
    <div class="brand">
      <span class="dot"></span>
      <span>Gatundos • Menu</span>
    </div>
    <nav>
      <ul>
        <!-- Mantenha href e data-src coerentes com os caminhos válidos -->
        <li><a href="/Board Beta/Menu/Cla.html" data-src="/Board Beta/Menu/Cla.html">Clãs</a></li>
        <li><a href="/Board Beta/Menu/Personagens.html" data-src="/Board Beta/Menu/Personagens.html">Personagens</a></li>
        <li><a href="#paginas/cartas.html" data-src="paginas/cartas.html">Cartas</a></li>
        <li><a href="#paginas/arvore.html" data-src="paginas/arvore.html">Árvore de Habilidades</a></li>
        <li><a href="../Menu/hospital.html" data-src="../Menu/hospital.html">Hospital</a></li>
        <li><a href="#paginas/mercado.html" data-src="paginas/mercado.html">Mercado</a></li>
        <li><a href="#paginas/config.html" data-src="paginas/config.html">Configurações</a></li>
      </ul>
    </nav>
  </aside>

  <header>
    <div class="top-image-wrap">
      <img class="image" src="/images/logo.png" width="5%" alt="Seja bem vindo a Gatundo" />
    </div>
  </header>

  <main>
    <div class="frame-wrap" id="frameWrap">
      <button id="btnCloseFull" aria-label="Fechar tela cheia">Fechar ✕</button>
      <iframe
        id="viewer"
        title="Subpágina"
        src="about:blank"
        allow="fullscreen"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        sandbox="allow-forms allow-same-origin allow-scripts"
      ></iframe>
    </div>
  </main>

  <script>
    const iframe = document.getElementById('viewer');
    const links = Array.from(document.querySelectorAll('nav a[data-src]'));
    const frameWrap = document.getElementById('frameWrap');
    const btnClose = document.getElementById('btnCloseFull');

    function setActiveBySrc(src) {
      links.forEach(a => a.classList.toggle('active', a.dataset.src === src));
    }

    function navigateTo(src, push = true) {
      iframe.src = src;
      setActiveBySrc(src);
      if (push) location.hash = src;
    }

    async function enterFullscreen() {
      try {
        if (!document.fullscreenElement) {
          await frameWrap.requestFullscreen({ navigationUI: "hide" });
        }
      } catch (err) {
        console.warn('Não foi possível entrar em fullscreen:', err);
      }
    }

    async function exitFullscreen() {
      try {
        if (document.fullscreenElement) {
          await document.exitFullscreen();
        }
      } catch (err) {
        console.warn('Não foi possível sair do fullscreen:', err);
      }
    }

    // Clique no menu: trocar a página e entrar em fullscreen (gesto do usuário)
    links.forEach(a => {
      a.addEventListener('click', async (ev) => {
        ev.preventDefault();
        navigateTo(a.dataset.src, true);
        await enterFullscreen();
      });
    });

    // Botão "Fechar": sai do fullscreen
    btnClose.addEventListener('click', () => {
      exitFullscreen();
    });

    // Sincroniza UI ao entrar/sair do fullscreen (opcionalmente adicione lógica extra aqui)
    document.addEventListener('fullscreenchange', () => {
      const inFull = !!document.fullscreenElement;
      // O botão é controlado por CSS :fullscreen; aside/header são ocultos por CSS também.
      // Este handler existe para possíveis integrações futuras.
      console.log('Fullscreen:', inFull ? 'ativo' : 'inativo');
    });

    // Restaura a partir do hash (não solicita fullscreen aqui para evitar bloqueio)
    function initFromHash() {
      const src = location.hash ? location.hash.slice(1) : 'Menu/Cla.html';
      navigateTo(src, false);
    }
    window.addEventListener('hashchange', initFromHash);
    initFromHash();
  </script>
</body>
</html>
